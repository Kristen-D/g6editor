<template>
<div class="el-panel-bigscreen">
  <div class="el-panel-bigscreen-heading">
    <h3 class="el-panel-bigscreen-title"><i class="el-icon-caret-right title-symbol"></i>主机漏洞</h3>
  </div>
  <div class="el-panel-bigscreen-body">
    <div class="echartsbox8" id="bbvulnerability"></div>
  </div>
</div>
</template>

<script>
import echarts from 'echarts'
import {mapState} from 'vuex'
export default {
  computed: {
    ...mapState({
      activeScreen: state => state.context.activeScreen
    })
  },
  watch: {
    activeScreen: function() {
      if(this.activeScreen===3) {
        this.loadMapChart();
      }
    }
  },
  methods: {
    loadMapChart() {
      let myChart = echarts.init(document.getElementById('bbvulnerability'));

      let data2 = [{
          name: '漏出',
          value: 34
        },
        {
          name: '网络设备',
          value: 46
        },
        {
          name: 'Web服务器',
          value: 53
        },
        {
          name: '数据库服务器',
          value: 68
        },
        {
          name: 'DNS',
          value: 79
        }
      ];

      let option = {
        color: ["#ff8400", '#ff2a00', '#ffdd3f'],
        title: [{
            text: '涉及资产16个',
            textAlign: 'center',
            bottom: '10%',
            left: '15%',
            textStyle: {
              color: '#dededf',
              fontSize: 16
              //  fontWeight: 'bolder'
            }
          },
          {
            text: '38',
            subtext: '总数',
            textAlign: 'center',
            top: '28%',
            left: '14%',
            textStyle: {
              color: '#fff',
              fontSize: 28,
              fontWeight: 'bolder'
            },

            subtextStyle: {
              color: '#dededf',
              fontSize: 16
            }
          }
        ],
        tooltip: {
          trigger: 'axis',
          axisPointer: { // 坐标轴指示器，坐标轴触发有效
            type: 'shadow' // 默认为直线，可选为：'line' | 'shadow'
          }
        },
        grid: {
          left: '35%',
          right: 10,
          top: '10%',
          height: 170,
          containLabel: true
        },
        yAxis: {
          type: 'category',
          data: ['DNS', '数据库服务器', 'Web服务器', '网络设备', '漏出'],
          axisLine: {
            show: false
          },
          axisTick: {
            show: false,
            alignWithLabel: true
          },
          axisLabel: {
            margin: 10,
            textStyle: {
              fontSize: 16,
              color: '#dededf'
            }
          }
        },
        xAxis: {
          type: 'value',
          min: 0,
          max: 100,
          splitNumber: 5,
          splitLine: {
            show: false,
            lineStyle: {
              type: 'solid',
              color: '#23303f'
            }
          },
          axisTick: {
            show: false
          },
          axisLabel: {
            margin: 15,
            textStyle: {
              color: '#dededf'
            }
          }
        },

        series: [{
            name: '数量',
            type: 'bar',
            data: data2,
            // barCategoryGap: '35%',
            barWidth: 10,
            barGap: 10,
            itemStyle: {
              normal: {
                color: new echarts.graphic.LinearGradient(0, 0, 1, 0, [{
                  offset: 0,
                  color: '#e02b09' // 0% 处的颜色
                }, {
                  offset: 1,
                  color: '#e2e2e3' // 100% 处的颜色
                }], false)
              }
            }
          },
          {
            name: '饼图',
            type: 'pie',
            radius: ['45%', '55%'],
            center: ['15%', '40%'],
            avoidLabelOverlap: false,
            label: {
              normal: {
                show: false,
                position: 'inside'
              },
              emphasis: {
                show: true,
                formatter: '{b}: {d}',
                textStyle: {
                  fontSize: '14'
                }
              }
            },
            labelLine: {
              normal: {
                show: false
              }
            },
            data: [{
              value: 11,
              name: '中危'
            }, {
              value: 5,
              name: '高危'
            }, {
              value: 22,
              name: '低危'
            }]
          }
        ]
      };

      myChart.setOption(option);
      window.onresize = myChart.resize;
    }
  },
  mounted: function() {
    // this.loadMapChart();
  }
}
</script>

<style lang="css">
</style>
