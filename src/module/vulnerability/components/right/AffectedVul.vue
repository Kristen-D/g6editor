<template>
<div class="el-panel">
  <div class="">

    <el-tabs class="zixtabs" v-model="activeTab" @tab-click="handleClick">
      <el-tab-pane label="漏洞资产TOP" name="asset"></el-tab-pane>
      <el-tab-pane label="漏洞单位TOP" name="department"></el-tab-pane>
    </el-tabs>

  </div>
  <div class="el-panel-body" style="height: 192px;">
    <div class="echartbox16" id="affectedVul"></div>
  </div>
</div>
</template>

<script>
export default {
  data() {
    return {
      activeTab:'asset'
    }
  },
  methods: {
    handleClick(tab, event) {
      let param = {type: tab===undefined? this.activeTab:tab.name, 'url':'/ssa/vulnerabilitystat/getVulnerabilityBelongs.do'};
      this.getInitData(param);
    },
    getInitData(obj) {
      this.common.req(obj.url, {obj}, this).then((data) => {
        this.loadMapChart(data);
      })
    },
    loadMapChart(data) {
      let datax = [];
      let datav = [];
      for(let d of data) {
        datax.push(d.name);
        datav.push(d.value);
      }
      let myChart = echarts.init(document.getElementById('affectedVul'));
      let option = {
        color: ['#ff7d27'],
        tooltip: {
          trigger: 'axis',
          axisPointer: {
            type: 'shadow',
          }
        },
        grid: {
          top: '10%',
          left: '-10',
          right: '4%',
          bottom: '3%',
          containLabel: true,
        },
        xAxis: [{
          type: 'category',
          boundaryGap: true,
          axisTick: {
            inside: true,
            alignWithLabel: true, //在 boundaryGap 为 true 的时候有效，可以保证刻度线和标签对齐
          },
          axisLine: {
            show: false,
          },
          splitLine: {
            show: false,
            lineStyle: {
              color: '#e1e3e4',
              type: 'solid'
            }
          },
          data: datax,
          // ['资产1', '资产2', '资产3', '资产4', '资产5'],
        }],
        yAxis: [{
          type: 'value',
          axisTick: {
            show: false
          },
          axisLine: {
            show: false
          },
          axisLabel: {
            show: false
          },
          splitLine: {
            show: true,
            lineStyle: {
              color: '#e1e3e4',
              type: 'solid'
            },
          },
        }],
        series: [{

          name: '直接访问',
          type: 'bar',
          barWidth: '26%',
          data: datav
          // [20, 36, 38, 42, 56]
        }]
      };
      myChart.setOption(option);
      window.onresize = myChart.resize;

    }

  },
  created: function() {


  },
  mounted: function() {
    this.handleClick();
  }
}
</script>

<style>
</style>
